<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Discord Casino UI</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg: #2f3136;
      --panel: #36393f;
      --surface: #2f3136;
      --text: #e4e6eb;
      --muted: #b9bec9;
      --accent: #5865F2; /* blurple */
      --green: #2ECC71;
      --red: #ED4245;
      --card: #42464b;
      --shadow: 0 6px 20px rgba(0,0,0,.25);
    }
    *{box-sizing:border-box}
    html,body,#root{height:100%}
    body{margin:0;background:linear-gradient(#2f3136,#2a2d33 60%,#1b1f23);font-family:Inter, system-ui, -apple-system, Arial, sans-serif;color:var(--text);}    
    .app{display:flex;gap:20px;min-height:100vh;padding:20px;}
    .sidebar{width:260px;min-width:200px;background:rgba(0,0,0,.25);border:1px solid rgba(255,255,255,.08);border-radius:14px;padding:12px;backdrop-filter: blur(4px)}
    .brand{display:flex;align-items:center;gap:10px;padding:12px;border-radius:12px;background: linear-gradient(135deg, rgba(88,101,242,.2), rgba(255,255,255,.02));border:1px solid rgba(88,101,242,.4)}
    .brand .avatar{width:28px;height:28px;border-radius:50%;background:#5865F2;display:inline-block}
    .brand .title{font-weight:600;font-size:14px}
    .nav{margin-top:8px}
    .nav button{width:100%;text-align:left;background:transparent;border:1px solid rgba(255,255,255,.12);color:var(--text);padding:12px 12px;border-radius:10px;margin-bottom:8px;cursor:pointer;font-weight:600}
    .nav button.active{background:var(--accent);border-color:var(--accent);box-shadow:0 4px 12px rgba(88,101,242,.4)}
    .content{flex:1;min-width:0;display:flex;flex-direction:column;gap:16px}
    .card{background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(0,0,0,.04));border:1px solid rgba(255,255,255,.08);border-radius:14px;padding:14px;box-shadow:var(--shadow)}
    .message{display:flex;gap:12px;align-items:flex-start}
    .avatar-lg{width:40px;height:40px;border-radius:50%;background:#5865F2;flex:0 0 auto}
    .author{font-weight:700;font-size:14px}
    .timestamp{color:var(--muted);font-size:12px;margin-left:6px}
    .content-area{margin-top:6px;color:#e5e7eb;line-height:1.5}
    .embed{border-left:4px solid #5865F2;padding-left:12px}
    .grid{display:grid;grid-template-columns:1fr;gap:12px}
    @media (min-width: 980px){
      .grid{grid-template-columns:1fr 1fr}
    }
    .panel{display:flex;flex-direction:column;gap:12px}
    .row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
    .input{padding:10px 12px;border-radius:8px;border:1px solid rgba(255,255,255,.2);background:#fff0}
    .btn{padding:10px 14px;border-radius:8px;border:none;cursor:pointer;font-weight:700}
    .btn.primary{background:var(--accent);color:white}
    .btn.secondary{background:#343a40;color:white}
    .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,.25);color:white}
    .chip{padding:6px 10px;border-radius:999px;background:#2a2e33;border:1px solid rgba(255,255,255,.15);font-size:12px}
    .cards{display:flex;gap:8px;flex-wrap:wrap}
    .card-slot{width:64px;height:90px;background:#1e1f24;border-radius:6px;display:flex;align-items:center;justify-content:center;color:#fff;border:1px solid #2a2a2a}
    .card-small{width:40px;height:60px;border-radius:6px;background:#1a1f24;display:flex;align-items:center;justify-content:center;font-size:12px}
    .deck{display:flex;gap:6px;flex-wrap:wrap}
    .bal{font-weight:700}
    .toast{position:fixed;bottom:14px;right:14px;background:#333;border-radius:8px;padding:12px 14px;color:white;box-shadow:0 6px 20px rgba(0,0,0,.4)}
  </style>
</head>
<body>
  <div id="root"></div>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script type="text/babel">
    const { useState, useEffect, useMemo } = React;

    // Utilities
    function createDeck(){
      const ranks = ['2','3','4','5','6','7','8','9','10','J','Q','K','A'];
      const suits = ['♠','♥','♦','♣'];
      const deck = [];
      for(const r of ranks){
        for(const s of suits){
          deck.push({rank: r, suit: s, id: r+s});
        }
      }
      // shuffle
      for(let i=deck.length-1;i>0;i--){
        const j = Math.floor(Math.random()* (i+1));
        [deck[i], deck[j]] = [deck[j], deck[i]];
      }
      return deck;
    }
    function cardValue(card){
      const r = card.rank;
      if(['J','Q','K'].includes(r)) return 10;
      if(r==='A') return 11;
      return parseInt(r,10);
    }
    function handValue(hand){
      let sum = hand.reduce((a,c)=>a+cardValue(c),0);
      let aces = hand.filter(c=>c.rank==='A').length;
      while(sum>21 && aces>0){ sum-=10; aces--; }
      return sum;
    }
    function renderCardText(card){ return card.rank + card.suit; }

    // Discord-like components
    function Section({children}){
      return <div className="card">
        <div className="message" aria-label="discord-message">
          <div className="avatar-lg" aria-label="avatar" />
          <div className="content-area" style={{width:'100%'}}>{children}</div>
        </div>
      </div>;
    }
    function Pill({children}){ return <span className="chip" role="note">{children}</span>; }

    // Blackjack Panel
    function BlackjackPanel({balance, setBalance}){
      const [bet, setBet] = useState(100);
      const [deck, setDeck] = useState([]);
      const [player, setPlayer] = useState([]);
      const [dealer, setDealer] = useState([]);
      const [inPlay, setInPlay] = useState(false);
      const [message, setMessage] = useState('Place a bet and press Deal to start.');
      const [roundOver, setRoundOver] = useState(false);

      function dealNewRound(){
        if(bet<=0 || bet>balance) { setMessage('Insufficient balance for this bet.'); return; }
        const d = createDeck();
        const p = [d.pop(), d.pop()];
        const dl = [d.pop(), d.pop()];
        setDeck(d);
        setPlayer(p);
        setDealer(dl);
        setInPlay(true);
        setRoundOver(false);
        setMessage('Your move: Hit or Stand');
      }
      function hit(){
        if(!inPlay) return;
        const d = deck.slice();
        const card = d.pop();
        const newPlayer = player.concat(card);
        setDeck(d);
        setPlayer(newPlayer);
        const val = handValue(newPlayer);
        if(val>21){
          // bust
          endRound('Bust! You lose the bet.');
        }
      }
      function stand(){
        if(!inPlay) return;
        // dealer plays
        let d = deck.slice();
        let dl = dealer.slice();
        // reveal dealer until >=17
        while(handValue(dl) < 17){
          const c = d.pop();
          if(!c) break;
          dl = dl.concat(c);
        }
        setDeck(d);
        setDealer(dl);
        const pVal = handValue(player);
        const dlVal = handValue(dl);
        let result = '';
        if(dlVal>21 || pVal>dlVal){ // player wins
          result = 'You win!';
          setBalanceLocal(balance + bet);
        } else if(pVal<dlVal){
          result = 'Dealer wins.';
          setBalanceLocal(Math.max(0, balance - bet));
        } else {
          result = 'Push. It\'s a draw.';
        }
        endRound(result);
      }
      function endRound(msg){
        setMessage(msg);
        setInPlay(false);
        setRoundOver(true);
      }
      function setBalanceLocal(newBal){
        setBalance(Math.max(0, newBal));
        // update global balance in parent
        setBalanceGlobal(newBal);
      }
      // local state bridging to parent balance
      const [balanceState, setBalanceState] = useState(balance);
      const setBalanceGlobal = (newVal)=>{
        // update in parent balance state
        // Here we mutate via parent setBalance function in a simple way
        // We'll keep balance in App; this function will call setBalance in App via effect
        // Instead, we simply update balance via a callback in App. We'll expose a small prop? Simpler: useBalance hook in App
      };
      // Note: We'll instead manage balance at App level and pass a setter; for simplicity, we'll mutate via onBalanceChange from props.
      return (
        <Section>
          <div className="row" aria-label="blackjack-header" style={{justifyContent:'space-between', alignItems:'center'}}>
            <div><strong>Blackjack</strong> <span className="chip">Balance: {balance}</span></div>
            <div className="row" aria-label="bet-controls">
              <input aria-label="bet-amount" className="input" type="number" min={1} value={bet} onChange={e=>setBet(Math.max(1, Number(e.target.value||1)))} style={{width:100}} />
              <button className="btn primary" onClick={dealNewRound}>Deal</button>
            </div>
          </div>
          <div className="grid">
            <div className="card" aria-label="player-area">
              <div style={{fontWeight:600, marginBottom:6}}>Player Hand ({handValue(player)})</div>
              <div className="deck" aria-label="player-cards">
                {player.map((c,i)=> <span key={i} className="card-small" title={c.id}>{c.rank}{c.suit}</span>)}
              </div>
            </div>
            <div className="card" aria-label="dealer-area">
              <div style={{fontWeight:600, marginBottom:6}}>Dealer Hand ({roundOver ? handValue(dealer) : handValue([dealer[0]])} {roundOver ? '' : ''})</div>
              <div className="deck" aria-label="dealer-cards">
                {dealer.length>0 ? dealer.map((c,i)=> <span key={i} className="card-small" title={c.id}>{i===0 ? c.rank+c.suit : '??'}</span>) : <span className="card-small">?</span>}
              </div>
            </div>
          </div>
          <div className="row" aria-label="blackjack-actions">
            <button className="btn" onClick={hit} disabled={!inPlay} aria-label="hit">Hit</button>
            <button className="btn" onClick={stand} disabled={!inPlay} aria-label="stand">Stand</button>
          </div>
          <div className="embed" aria-label="blackjack-result" style={{borderLeftColor:'#4e8af7', paddingLeft:12}}>
            <div id="bj-msg">{message}</div>
          </div>
        </Section>
      );
    }

    // Roulette Panel
    const colorOf = (n)=>{
      const red = new Set([1,3,5,7,9,12,14,16,18,19,21,23,25,27,30,32,34,36]);
      if(n===0) return 'green';
      return red.has(n)? 'red':'black';
    };
    function RoulettePanel({balance, setBalance}){
      const [bet, setBet] = useState(50);
      const [betType, setBetType] = useState('color');
      const [color, setColor] = useState('red');
      const [number, setNumber] = useState(0);
      const [result, setResult] = useState(null);

      function spin(){
        if(bet<=0 || bet>balance){ alert('Invalid bet'); return; }
        const n = Math.floor(Math.random()*37);
        const win = (betType==='color' && colorOf(n)===color) || (betType==='number' && n===Number(number));
        let newBal = balance;
        if(win){ newBal += bet; }
        else { newBal -= bet; }
        setBalance(newBal);
        setResult({number:n, color: colorOf(n), win});
      }
      return (
        <Section>
          <div className="row" aria-label="roulette-header" style={{justifyContent:'space-between'}}>
            <div><strong>Roulette</strong> <span className="chip">Balance: {balance}</span></div>
            <div className="row" aria-label="bet-controls">
              <input className="input" type="number" min={1} value={bet} onChange={e=>setBet(Number(e.target.value||1))} style={{width:100}} aria-label="bet-amount-roulette"/>
              <button className="btn primary" onClick={spin} aria-label="spin">Spin</button>
            </div>
          </div>
          <div className="grid">
            <div className="card" aria-label="roulette-bet">
              <div style={{fontWeight:600, marginBottom:6}}>Bet Type</div>
              <div className="row">
                <button className={"btn " + (betType==='color'?'primary':'secondary')} onClick={()=>setBetType('color')} aria-label="bet-color">Color</button>
                <button className={"btn " + (betType==='number'?'primary':'secondary')} onClick={()=>setBetType('number')} aria-label="bet-number">Number</button>
              </div>
              {betType==='color' ? (
                <div className="row" style={{marginTop:8}}>
                  {['red','black','green'].map(c=> (
                    <button key={c} className={"btn ghost" + (color===c?' active':'')} onClick={()=>setColor(c)} aria-label={`color-${c}`} style={{borderColor: color===c?'#fff':'rgba(255,255,255,.25)'}}> {c} </button>
                  ))}
                </div>
              ) : (
                <div className="row" style={{marginTop:8}}>
                  <input className="input" type="number" min={0} max={36} value={number} onChange={e=>setNumber(Number(e.target.value||0))} aria-label="roulette-number" style={{width:100}}/>
                </div>
              )}
            </div>
            <div className="card" aria-label="roulette-preview">
              <div style={{fontWeight:600}}>Wheel Spin Preview</div>
              <div className="row" style={{marginTop:8}}>
                {Array.from({length:6}).map((_,i)=> (
                  <span key={i} className="card-slot" aria-label="slot">{Math.floor(Math.random()*37)}</span>
                ))}
              </div>
            </div>
          </div>
          {result && (
            <div className="embed" aria-label="roulette-result" style={{borderLeftColor: '#FFCC00', paddingLeft:12}}>
              <div>Result: #{result.number} ({result.color}) - {result.win ? 'You won!' : 'You lost'}</div>
            </div>
          )}
        </Section>
      );
    }

    // Shop Panel
    function ShopPanel({balance, setBalance}){
      const items = [
        {id:'chip_100', name:'Chip Pack 100', price:100},
        {id:'chip_500', name:'Chip Pack 500', price:450},
        {id:'chip_1000', name:'Chip Pack 1000', price:900},
        {id:'avatar', name:'Discord Avatar', price:1200},
      ];
      const [inventory, setInventory] = useState({});
      function buy(item){
        if(balance < item.price) { alert('Not enough balance'); return; }
        setBalance(balance - item.price);
        setInventory(prev => {
          const cur = Object.assign({}, prev);
          cur[item.id] = (cur[item.id]||0) + 1;
          return cur;
        });
      }
      return (
        <Section>
          <div className="row" aria-label="shop-header" style={{justifyContent:'space-between'}}>
            <div><strong>Shop</strong> <span className="chip">Balance: {balance}</span></div>
            <div className="row" aria-label="inventory">
              <span className="chip">Inventory: {Object.values(inventory).reduce((a,b)=>a+b,0)}</span>
            </div>
          </div>
          <div className="grid">
            {items.map(it => (
              <div key={it.id} className="card" aria-label={`shop-item-${it.name}`}>
                <div style={{fontWeight:600}}>{it.name}</div>
                <div style={{color:'#cfd8dc'}}>Price: {it.price} chips</div>
                <button className="btn primary" style={{marginTop:8}} onClick={()=>buy(it)}>Buy</button>
              </div>
            ))}
          </div>
        </Section>
      );
    }

    // App
    function App(){
      const [balance, setBalance] = useState(() => {
        const v = localStorage.getItem('discord_casino_balance');
        return v ? Number(v) : 1000;
      });
      const [active, setActive] = useState('blackjack');
      useEffect(()=>{ localStorage.setItem('discord_casino_balance', balance); }, [balance]);
      const Tabs = [
        {id:'blackjack', label:'Blackjack'},
        {id:'roulette', label:'Roulette'},
        {id:'shop', label:'Shop'}
      ];
      return (
        <div className="app" style={{paddingTop:20}}>
          <aside className="sidebar" aria-label="sidebar">
            <div className="brand">
              <span className="avatar" />
              <div>
                <div className="title">Discord Casino UI</div>
                <div style={{fontSize:12, color:'#cbd5e1'}}>Interactive casino controls</div>
              </div>
            </div>
            <nav className="nav" aria-label="game-nav">
              {Tabs.map(t => (
                <button key={t.id} className={active===t.id? 'active':''} onClick={()=>setActive(t.id)} aria-label={`tab-${t.id}`}>{t.label}</button>
              ))}
            </nav>
          </aside>
          <main className="content" aria-label="content-area">
            {active==='blackjack' && (
              < BlackjackPanel balance={balance} setBalance={setBalance} />
            )}
            {active==='roulette' && (
              < RoulettePanel balance={balance} setBalance={setBalance} />
            )}
            {active==='shop' && (
              < ShopPanel balance={balance} setBalance={setBalance} />
            )}
          </main>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
  <div id="toast" className="toast" role="status" aria-live="polite" style={{display:'none'}}></div>
</body>
</html>
